<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal CP IDE</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/solarized.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/material.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/nord.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/tomorrow-night-eighties.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/selection/active-line.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-dark: #0f1117;
            --panel-bg: #161b22;
            --border-col: #30363d;
            --accent: #238636; /* GitHub Green */
            --text-main: #c9d1d9;
            --text-dim: #8b949e;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-dark); 
            color: var(--text-main);
        }

        /* CodeMirror Customization */
        .CodeMirror { 
            height: 100%; 
            font-family: 'JetBrains Mono', monospace; 
            font-size: 14px; 
            line-height: 1.6;
            background-color: var(--panel-bg) !important;
        }
        
        /* Minimal Scrollbars */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #58a6ff; }

        /* Sidebar Buttons */
        .template-btn { 
            text-align: left; 
            transition: all 0.15s ease;
            font-size: 0.85rem;
            border-left: 2px solid transparent;
        }
        .template-btn:hover { 
            background-color: #21262d; 
            color: #58a6ff; 
            border-left: 2px solid #58a6ff;
            padding-left: 14px; /* Slight movement effect */
        }
        
        .section-title {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-dim);
            margin-top: 16px;
            margin-bottom: 8px;
            padding-left: 4px;
            font-weight: 600;
        }

        /* Utilities */
        .panel { background-color: var(--panel-bg); border: 1px solid var(--border-col); }
        .no-outline:focus { outline: none; }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">
    
    <header class="h-12 border-b border-[#30363d] flex justify-between items-center px-4 bg-[#161b22] shrink-0">
        <div class="flex items-center gap-3">
            <svg class="w-5 h-5 text-[#58a6ff]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
            <span class="font-semibold text-sm tracking-wide">CP<span class="text-gray-500">IDE</span></span>
        </div>
        
        <div class="flex items-center gap-3">
            <select id="theme-select" class="bg-[#0d1117] border border-[#30363d] text-xs text-gray-300 rounded px-2 py-1 outline-none focus:border-[#58a6ff]">
                <option value="dracula">Dracula</option>
                <option value="monokai">Monokai</option>
                <option value="solarized light">Solarized Light</option>
                <option value="material">Material</option>
                <option value="nord">Nord</option>
                <option value="tomorrow-night-eighties">Tomorrow Night</option>
            </select>

            <button id="run-btn" class="bg-[#238636] hover:bg-[#2ea043] text-white text-xs font-semibold px-4 py-1.5 rounded transition-colors flex items-center gap-2 border border-[rgba(240,246,252,0.1)]">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 16 16"><path d="M11.596 8.697l-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>
                Run
            </button>
        </div>
    </header>

    <div class="flex flex-grow overflow-hidden p-2 gap-2 bg-[#0d1117]">
        
        <aside class="w-56 panel rounded flex flex-col shrink-0">
            <div class="p-3 border-b border-[#30363d] text-xs font-semibold text-gray-300 bg-[#21262d]">LIBRARY</div>
            <div class="flex-grow overflow-y-auto p-2">
                
                <div class="section-title">Essential</div>
                <button onclick="setTemplate('empty')" class="template-btn w-full p-2 rounded text-gray-400">Empty Boilerplate</button>
                <button onclick="setTemplate('array')" class="template-btn w-full p-2 rounded text-gray-400">Input Array (n)</button>
                <button onclick="setTemplate('grid')" class="template-btn w-full p-2 rounded text-gray-400">Input Grid (nxm)</button>

                <div class="section-title">Math</div>
                <button onclick="setTemplate('nCr')" class="template-btn w-full p-2 rounded text-gray-400">Combinatorics (nCr)</button>
                <button onclick="setTemplate('primes')" class="template-btn w-full p-2 rounded text-gray-400">Sieve of Eratosthenes</button>
                <button onclick="setTemplate('binary_exp')" class="template-btn w-full p-2 rounded text-gray-400">Binary Exponentiation</button>

                <div class="section-title">Algorithms</div>
                <button onclick="setTemplate('binary_search')" class="template-btn w-full p-2 rounded text-gray-400">Binary Search</button>
                <button onclick="setTemplate('dsu')" class="template-btn w-full p-2 rounded text-gray-400">DSU (Union Find)</button>
                <button onclick="setTemplate('dijkstra')" class="template-btn w-full p-2 rounded text-gray-400">Dijkstra (Shortest Path)</button>
                <button onclick="setTemplate('segtree')" class="template-btn w-full p-2 rounded text-gray-400">Segment Tree</button>

                <div class="section-title">Strings</div>
                <button onclick="setTemplate('trie')" class="template-btn w-full p-2 rounded text-gray-400">Trie</button>
                <button onclick="setTemplate('hashing')" class="template-btn w-full p-2 rounded text-gray-400">String Hashing</button>
            </div>
        </aside>

        <div class="flex flex-col flex-grow w-0 panel rounded overflow-hidden relative">
            <div class="h-8 bg-[#21262d] border-b border-[#30363d] flex justify-between items-center px-3">
                <span class="text-xs text-gray-400">main.cpp</span>
                <button id="copy-btn" class="text-xs text-gray-500 hover:text-white transition-colors">Copy</button>
            </div>
            <div class="flex-grow relative">
                <textarea id="code-editor"></textarea>
            </div>
        </div>

        <div class="flex flex-col w-64 gap-2 shrink-0">
            <div class="flex flex-col h-1/2 panel rounded overflow-hidden">
                <div class="h-8 bg-[#21262d] border-b border-[#30363d] px-3 flex items-center text-xs font-semibold text-gray-400">Stdin</div>
                <textarea id="input-box" class="w-full h-full p-3 bg-[#0d1117] text-gray-300 resize-none outline-none font-mono text-sm border-none focus:ring-0"></textarea>
            </div>

            <div class="flex flex-col h-1/2 panel rounded overflow-hidden">
                <div class="h-8 bg-[#21262d] border-b border-[#30363d] px-3 flex justify-between items-center">
                    <span class="text-xs font-semibold text-gray-400">Stdout</span>
                    <span id="status" class="text-[10px] px-2 py-0.5 rounded-sm bg-[#30363d] text-gray-400">Idle</span>
                </div>
                <pre id="output-box" class="w-full h-full p-3 bg-[#0d1117] text-gray-300 overflow-auto font-mono text-sm whitespace-pre-wrap"></pre>
            </div>
        </div>
    </div>

    <script>
        // --- Editor Setup ---
        const editor = CodeMirror.fromTextArea(document.getElementById('code-editor'), {
            mode: "text/x-c++src",
            theme: "dracula",
            lineNumbers: true,
            autoCloseBrackets: true,
            styleActiveLine: true,
            indentUnit: 4,
            tabSize: 4,
            smartIndent: true
        });

        // --- Templates ---
        const templates = {
            'empty': `#include <bits/stdc++.h>
using namespace std;

#define ll long long
#define vi vector<int>
#define vll vector<long long>
#define pii pair<int, int>
#define all(x) (x).begin(), (x).end()

void solve() {
    
}

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    int t;
    cin >> t;
    while(t--) {
        solve();
    }
    return 0;
}`,

            'array': `#include <bits/stdc++.h>
using namespace std;
#define ll long long

void solve() {
    int n;
    cin >> n;
    vector<int> a(n);
    for(int i = 0; i < n; ++i) cin >> a[i];
    
    // Logic here
}

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,

            'grid': `#include <bits/stdc++.h>
using namespace std;

void solve() {
    int n, m;
    cin >> n >> m;
    vector<vector<int>> grid(n, vector<int>(m));
    for(int i = 0; i < n; i++) {
        for(int j = 0; j < m; j++) {
            cin >> grid[i][j];
        }
    }
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,

            'nCr': `#include <bits/stdc++.h>
using namespace std;
#define ll long long
const int MOD = 1e9 + 7;
const int MAXN = 200005;

ll fact[MAXN], invFact[MAXN];

ll binpow(ll a, ll b) {
    ll res = 1;
    while (b > 0) {
        if (b & 1) res = (res * a) % MOD;
        a = (a * a) % MOD;
        b >>= 1;
    }
    return res;
}

void precompute() {
    fact[0] = 1; invFact[0] = 1;
    for (int i = 1; i < MAXN; i++) {
        fact[i] = (fact[i - 1] * i) % MOD;
        invFact[i] = binpow(fact[i], MOD - 2);
    }
}

ll nCr(int n, int r) {
    if (r < 0 || r > n) return 0;
    return fact[n] * invFact[r] % MOD * invFact[n - r] % MOD;
}

void solve() {
    int n, r;
    cin >> n >> r;
    cout << nCr(n, r) << "\\n";
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    precompute();
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'binary_search': `#include <bits/stdc++.h>
using namespace std;

bool check(long long mid) {
    // Return true if mid is valid
    return true;
}

void solve() {
    long long n;
    cin >> n;
    
    long long low = 0, high = n, ans = -1;
    
    while(low <= high) {
        long long mid = low + (high - low) / 2;
        if(check(mid)) {
            ans = mid;
            // low = mid + 1; // if looking for max
            high = mid - 1; // if looking for min
        } else {
            // high = mid - 1; 
            low = mid + 1;
        }
    }
    cout << ans << "\\n";
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'primes': `#include <bits/stdc++.h>
using namespace std;
const int MAXN = 1000005;
vector<bool> is_prime(MAXN, true);
vector<int> primes;

void sieve() {
    is_prime[0] = is_prime[1] = false;
    for (int i = 2; i * i < MAXN; i++) {
        if (is_prime[i]) {
            for (int j = i * i; j < MAXN; j += i)
                is_prime[j] = false;
        }
    }
}

void solve() {
    int n; cin >> n;
    if(is_prime[n]) cout << "YES\\n"; else cout << "NO\\n";
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    sieve();
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,

            'dsu': `#include <bits/stdc++.h>
using namespace std;

struct DSU {
    vector<int> parent, size;
    DSU(int n) {
        parent.resize(n + 1);
        size.resize(n + 1, 1);
        iota(parent.begin(), parent.end(), 0);
    }
    int find(int x) {
        if (parent[x] == x) return x;
        return parent[x] = find(parent[x]);
    }
    void unite(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);
        if (rootX != rootY) {
            if (size[rootX] < size[rootY]) swap(rootX, rootY);
            parent[rootY] = rootX;
            size[rootX] += size[rootY];
        }
    }
};

void solve() {
    int n, m; cin >> n >> m;
    DSU dsu(n);
    while(m--) {
        int u, v; cin >> u >> v;
        dsu.unite(u, v);
    }
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'segtree': `#include <bits/stdc++.h>
using namespace std;
#define ll long long

const int MAXN = 200005;
ll tree[4 * MAXN];
ll arr[MAXN];

void build(int node, int start, int end) {
    if(start == end) {
        tree[node] = arr[start];
    } else {
        int mid = (start + end) / 2;
        build(2 * node, start, mid);
        build(2 * node + 1, mid + 1, end);
        tree[node] = tree[2 * node] + tree[2 * node + 1]; // Sum
    }
}

void update(int node, int start, int end, int idx, int val) {
    if(start == end) {
        arr[idx] = val;
        tree[node] = val;
    } else {
        int mid = (start + end) / 2;
        if(start <= idx && idx <= mid) update(2 * node, start, mid, idx, val);
        else update(2 * node + 1, mid + 1, end, idx, val);
        tree[node] = tree[2 * node] + tree[2 * node + 1];
    }
}

ll query(int node, int start, int end, int l, int r) {
    if(r < start || end < l) return 0;
    if(l <= start && end <= r) return tree[node];
    int mid = (start + end) / 2;
    return query(2 * node, start, mid, l, r) + query(2 * node + 1, mid + 1, end, l, r);
}

void solve() {
    int n; cin >> n;
    for(int i=1; i<=n; i++) cin >> arr[i];
    build(1, 1, n);
    // query(1, 1, n, l, r);
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'dijkstra': `#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define pii pair<int, int>

void solve() {
    int n, m;
    cin >> n >> m;
    vector<vector<pii>> adj(n + 1);
    for(int i=0; i<m; i++) {
        int u, v, w; cin >> u >> v >> w;
        adj[u].push_back({v, w});
        adj[v].push_back({u, w}); 
    }
    
    priority_queue<pii, vector<pii>, greater<pii>> pq;
    vector<ll> dist(n + 1, 1e18);
    
    dist[1] = 0;
    pq.push({0, 1}); // {dist, node}
    
    while(!pq.empty()) {
        ll d = pq.top().first;
        int u = pq.top().second;
        pq.pop();
        
        if(d > dist[u]) continue;
        
        for(auto& edge : adj[u]) {
            int v = edge.first;
            int w = edge.second;
            if(dist[u] + w < dist[v]) {
                dist[v] = dist[u] + w;
                pq.push({dist[v], v});
            }
        }
    }
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'trie': `#include <bits/stdc++.h>
using namespace std;

struct Node {
    Node *links[26];
    bool flag = false;
    bool containsKey(char ch) { return links[ch - 'a'] != NULL; }
    void put(char ch, Node *node) { links[ch - 'a'] = node; }
    Node *get(char ch) { return links[ch - 'a']; }
    void setEnd() { flag = true; }
    bool isEnd() { return flag; }
};

class Trie {
private: Node* root;
public:
    Trie() { root = new Node(); }
    
    void insert(string word) {
        Node *node = root;
        for (int i = 0; i < word.length(); i++) {
            if (!node->containsKey(word[i])) {
                node->put(word[i], new Node());
            }
            node = node->get(word[i]);
        }
        node->setEnd();
    }
    
    bool search(string word) {
        Node *node = root;
        for (int i = 0; i < word.length(); i++) {
            if (!node->containsKey(word[i])) return false;
            node = node->get(word[i]);
        }
        return node->isEnd();
    }
};

void solve() {
    Trie T;
    // T.insert("hello");
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`,
            'hashing': `#include <bits/stdc++.h>
using namespace std;
#define ll long long

void solve() {
    string s; cin >> s;
    int n = s.length();
    
    ll p = 31;
    ll m = 1e9 + 9;
    
    vector<ll> p_pow(n);
    p_pow[0] = 1;
    for (int i = 1; i < n; i++) 
        p_pow[i] = (p_pow[i-1] * p) % m;

    vector<ll> h(n + 1, 0); 
    for (int i = 0; i < n; i++)
        h[i+1] = (h[i] + (s[i] - 'a' + 1) * p_pow[i]) % m;
        
    // Substring hash from i to j
    // cur_h = (h[j+1] - h[i] + m) % m;
    // cur_h = (cur_h * p_pow[n-1-i]) % m; // Normalize
}

int main() {
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    int t; cin >> t;
    while(t--) solve();
    return 0;
}`
        };

        function setTemplate(key) {
            editor.setValue(templates[key]);
            editor.clearHistory();
        }

        setTemplate('empty');

        // --- Copy Logic ---
        document.getElementById('copy-btn').addEventListener('click', () => {
            navigator.clipboard.writeText(editor.getValue());
            const btn = document.getElementById('copy-btn');
            btn.textContent = 'Copied!';
            btn.classList.add('text-green-500');
            setTimeout(() => { 
                btn.textContent = 'Copy'; 
                btn.classList.remove('text-green-500');
            }, 1500);
        });

        // --- Theme Switching ---
        const themeSelect = document.getElementById('theme-select');
        themeSelect.addEventListener('change', (e) => {
            editor.setOption('theme', e.target.value);
        });

        // --- Execution Logic ---
        const runBtn = document.getElementById('run-btn');
        const statusSpan = document.getElementById('status');
        const outputBox = document.getElementById('output-box');

        runBtn.addEventListener('click', async () => {
            const source = editor.getValue();
            const inp = document.getElementById('input-box').value;
            
            runBtn.disabled = true;
            runBtn.classList.add('opacity-50');
            runBtn.innerHTML = '...';
            statusSpan.textContent = 'Running';
            statusSpan.className = 'text-[10px] px-2 py-0.5 rounded-sm bg-yellow-600 text-white';
            outputBox.textContent = '';

            try {
                const res = await fetch('https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=true&wait=true', {
                    method: 'POST',
                    headers: {
                        'content-type': 'application/json',
                        'x-rapidapi-host': 'judge0-ce.p.rapidapi.com',
                        'x-rapidapi-key': 'ab79e2474cmshf8e3506939160bbp104df9jsn0ec64fadde4c'
                    },
                    body: JSON.stringify({
                        language_id: 54,
                        source_code: btoa(source),
                        stdin: btoa(inp)
                    })
                });
                
                const result = await res.json();
                
                if (result.status.id === 3) {
                    statusSpan.textContent = 'Accepted';
                    statusSpan.className = 'text-[10px] px-2 py-0.5 rounded-sm bg-[#238636] text-white';
                    outputBox.textContent = atob(result.stdout || '');
                } else if (result.status.id === 6) {
                    statusSpan.textContent = 'Compilation Error';
                    statusSpan.className = 'text-[10px] px-2 py-0.5 rounded-sm bg-red-600 text-white';
                    outputBox.textContent = atob(result.compile_output || '');
                } else {
                    statusSpan.textContent = result.status.description;
                    statusSpan.className = 'text-[10px] px-2 py-0.5 rounded-sm bg-red-600 text-white';
                    outputBox.textContent = (result.stderr ? atob(result.stderr) + '\n' : '') + (result.stdout ? atob(result.stdout) : '');
                }

            } catch (e) {
                outputBox.textContent = "Error: " + e.message;
            } finally {
                runBtn.disabled = false;
                runBtn.classList.remove('opacity-50');
                runBtn.innerHTML = `<svg class="w-3 h-3" fill="currentColor" viewBox="0 0 16 16"><path d="M11.596 8.697l-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg> Run`;
            }
        });
    </script>
</body>
</html>