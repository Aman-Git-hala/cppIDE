<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C++ IDE for CP</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/solarized.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/closebrackets.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Fira+Code&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c1021;
        }
        .CodeMirror {
            height: 100%;
            font-size: 16px;
            line-height: 1.5;
            font-family: 'Fira Code', monospace;
        }
        .CodeMirror-gutters {
            background-color: #1e1e1e !important;
        }
        .cm-s-dracula.CodeMirror { background: #1e1e1e; }
        .cm-s-monokai.CodeMirror { background: #272822; }
        .cm-s-solarized.light.CodeMirror { background: #fdf6e3; color: #657b83; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1a1b26; }
        ::-webkit-scrollbar-thumb { background: #44475a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6272a4; }

        .panel-header {
            background: linear-gradient(to right, #1a202c, #2d3748);
        }
        
        #theme-dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: #2d3748;
            border: 1px solid #4a5568;
            z-index: 50;
        }

        .run-button-glow {
            box-shadow: 0 0 5px #0e9f6e, 0 0 10px #0e9f6e, 0 0 15px #0e9f6e;
        }
    </style>
</head>
<body class="text-white flex flex-col h-screen overflow-hidden">
    <header class="bg-[#111827] border-b border-gray-700 shadow-2xl p-3 flex justify-between items-center z-20">
        <div class="flex items-center gap-3">
            <svg class="w-8 h-8 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0021 18V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v12a2.25 2.25 0 002.25 2.25z" />
            </svg>
            <h1 class="text-xl font-bold text-gray-200">Personal C++ IDE</h1>
        </div>
        <div class="flex items-center gap-4">
            <div class="relative">
                <button id="theme-button" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center gap-2">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.47 2.118v-.09A12.75 12.75 0 0112 3c2.618 0 5.093.993 7.025 2.735a3 3 0 00-5.78-1.128 2.25 2.25 0 01-2.47-2.118v.09A12.755 12.755 0 0112 21c-2.618 0-5.093-.993-7.025-2.735z" /></svg>
                    <span>Theme</span>
                </button>
                <div id="theme-dropdown" class="rounded-md shadow-lg w-32 mt-2">
                    <a href="#" data-theme="dracula" class="block px-4 py-2 text-sm text-gray-200 hover:bg-cyan-500 hover:text-white rounded-t-md">Dracula</a>
                    <a href="#" data-theme="monokai" class="block px-4 py-2 text-sm text-gray-200 hover:bg-cyan-500 hover:text-white">Monokai</a>
                    <a href="#" data-theme="solarized light" class="block px-4 py-2 text-sm text-gray-200 hover:bg-cyan-500 hover:text-white rounded-b-md">Solarized Light</a>
                </div>
            </div>
            <button id="run-button" class="bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-all duration-300 flex items-center space-x-2 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 hover:run-button-glow">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>
                <span>Run Code</span>
            </button>
        </div>
    </header>

    <div class="flex flex-grow overflow-hidden p-2 gap-2">
        <div class="flex flex-col w-2/3 h-full bg-[#1e1e1e] rounded-lg shadow-lg border border-gray-700">
            <div class="panel-header p-2 rounded-t-lg text-sm text-gray-300 font-semibold flex justify-between items-center">
                <span>main.cpp</span>
                <button id="copy-button" class="text-gray-400 hover:text-white transition-colors">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.5l-3-3m0 0l-3 3m3-3v12" /></svg>
                </button>
            </div>
            <div class="flex-grow relative"><textarea id="code-editor"></textarea></div>
        </div>

        <div class="flex flex-col w-1/3 h-full gap-2">
            <div class="flex flex-col h-1/2 bg-[#1e1e1e] rounded-lg shadow-lg border border-gray-700">
                <div class="panel-header p-2 rounded-t-lg text-sm text-gray-300 font-semibold flex justify-between items-center">
                    <span>Standard Input (stdin)</span>
                    <button id="clear-input-button" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9.75L14.25 12m0 0l2.25 2.25M14.25 12L12 14.25m-2.58 4.92l-6.375-6.375a1.125 1.125 0 010-1.591l6.375-6.375a1.125 1.125 0 011.591 0l6.375 6.375a1.125 1.125 0 010 1.591l-6.375 6.375a1.125 1.125 0 01-1.591 0z" /></svg>
                    </button>
                </div>
                <textarea id="input-box" class="w-full h-full p-3 bg-[#111827] text-gray-200 rounded-b-lg border-none focus:outline-none resize-none font-mono" placeholder="Enter input..."></textarea>
            </div>

            <div class="flex flex-col h-1/2 bg-[#1e1e1e] rounded-lg shadow-lg border border-gray-700">
                <div class="panel-header p-2 rounded-t-lg text-sm text-gray-300 font-semibold flex justify-between items-center">
                    <span>Output</span>
                    <div id="status" class="text-xs px-2.5 py-1 rounded-full font-medium"></div>
                </div>
                <pre id="output-box" class="w-full h-full p-3 bg-[#111827] text-gray-200 rounded-b-lg overflow-auto font-mono whitespace-pre-wrap break-words"></pre>
            </div>
        </div>
    </div>

    <script>
        const editor = CodeMirror.fromTextArea(document.getElementById('code-editor'), {
            mode: "text/x-c++src",
            theme: "dracula",
            lineNumbers: true,
            autoCloseBrackets: true,
            indentUnit: 4,
        });

        editor.setValue(`#include <bits/stdc++.h>

using namespace std;

void solve() {
    
}

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);

    int t;
    cin >> t;
    while (t--) {
        solve();
    }
    
    return 0;
}`);

        const runButton = document.getElementById('run-button');
        const inputBox = document.getElementById('input-box');
        const outputBox = document.getElementById('output-box');
        const statusDiv = document.getElementById('status');
        const themeButton = document.getElementById('theme-button');
        const themeDropdown = document.getElementById('theme-dropdown');
        const copyButton = document.getElementById('copy-button');
        const clearInputButton = document.getElementById('clear-input-button');
        
        runButton.addEventListener('click', runCode);
        
        themeButton.addEventListener('click', () => {
            themeDropdown.style.display = themeDropdown.style.display === 'block' ? 'none' : 'block';
        });

        document.addEventListener('click', (event) => {
            if (!themeButton.contains(event.target) && !themeDropdown.contains(event.target)) {
                themeDropdown.style.display = 'none';
            }
        });

        themeDropdown.addEventListener('click', (event) => {
            event.preventDefault();
            const theme = event.target.dataset.theme;
            if (theme) {
                editor.setOption('theme', theme);
                themeDropdown.style.display = 'none';
            }
        });

        copyButton.addEventListener('click', () => {
            const code = editor.getValue();
            const textarea = document.createElement('textarea');
            textarea.value = code;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            copyButton.innerHTML = `<svg class="w-5 h-5 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg>`;
            setTimeout(() => {
                copyButton.innerHTML = `<svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.5l-3-3m0 0l-3 3m3-3v12" /></svg>`;
            }, 1500);
        });

        clearInputButton.addEventListener('click', () => {
            inputBox.value = '';
        });

        const API_CONFIG = {
            url: 'https://judge0-ce.p.rapidapi.com/submissions',
            host: 'judge0-ce.p.rapidapi.com',
            apiKey: 'ab79e2474cmshf8e3506939160bbp104df9jsn0ec64fadde4c'
        };

        async function runCode() {
            const sourceCode = editor.getValue();
            const stdin = inputBox.value;

            runButton.disabled = true;
            runButton.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Running...`;
            runButton.classList.add('opacity-70', 'cursor-not-allowed');
            statusDiv.textContent = 'Submitting...';
            statusDiv.className = 'text-xs px-2.5 py-1 rounded-full font-medium bg-yellow-500 text-black';
            outputBox.textContent = '';
            
            const payload = {
                language_id: 54, 
                source_code: btoa(sourceCode),
                stdin: btoa(stdin)
            };

            try {
                const submissionResponse = await fetch(`${API_CONFIG.url}?base64_encoded=true&wait=false`, {
                    method: 'POST',
                    headers: {
                        'x-rapidapi-host': API_CONFIG.host,
                        'x-rapidapi-key': API_CONFIG.apiKey,
                        'content-type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });

                if (!submissionResponse.ok) {
                    const errorBody = await submissionResponse.json();
                    throw new Error(errorBody.message || submissionResponse.statusText);
                }

                const submissionResult = await submissionResponse.json();
                const submissionToken = submissionResult.token;

                if (!submissionToken) throw new Error('Failed to get submission token.');

                let finalResult;
                while (true) {
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    const resultResponse = await fetch(`${API_CONFIG.url}/${submissionToken}?base64_encoded=true`, {
                        method: 'GET',
                        headers: {
                            'x-rapidapi-host': API_CONFIG.host,
                            'x-rapidapi-key': API_CONFIG.apiKey
                        }
                    });

                    if (!resultResponse.ok) {
                         const errorBody = await resultResponse.json();
                         throw new Error(errorBody.message || resultResponse.statusText);
                    }
                    
                    const result = await resultResponse.json();
                    if (result.status.id > 2) {
                        finalResult = result;
                        break;
                    }
                     statusDiv.textContent = `Status: ${result.status.description}...`;
                }
                displayOutput(finalResult);
            } catch (error) {
                outputBox.textContent = `An error occurred: ${error.message}`;
                statusDiv.textContent = 'API Error';
                statusDiv.className = 'text-xs px-2.5 py-1 rounded-full font-medium bg-red-600 text-white';
            } finally {
                runButton.disabled = false;
                runButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg><span>Run Code</span>`;
                runButton.classList.remove('opacity-70', 'cursor-not-allowed');
            }
        }

        function displayOutput(result) {
            let output = '';
            let statusText = result.status.description;
            let statusColor = 'bg-blue-500 text-white';

            if (result.status.id === 3) { 
                output = result.stdout ? atob(result.stdout) : '(No output)';
                statusColor = 'bg-green-500 text-white';
            } 
            else if (result.status.id === 6) { 
                output = result.compile_output ? atob(result.compile_output) : 'Compilation Error';
                statusColor = 'bg-red-600 text-white';
            } 
            else { 
                output += `Status: ${result.status.description}\n`;
                output += `Time: ${result.time}s\n`;
                output += `Memory: ${result.memory} KB\n\n`;
                output += result.stderr ? `--- Stderr ---\n${atob(result.stderr)}\n\n` : '';
                output += result.stdout ? `--- Stdout ---\n${atob(result.stdout)}` : '';
                statusColor = 'bg-red-600 text-white';
            }
            outputBox.textContent = output;
            statusDiv.textContent = statusText;
            statusDiv.className = `text-xs px-2.5 py-1 rounded-full font-medium ${statusColor}`;
        }
    </script>
</body>
</html>

